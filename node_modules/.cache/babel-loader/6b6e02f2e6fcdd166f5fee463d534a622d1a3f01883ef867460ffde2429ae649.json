{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, vModelSelect as _vModelSelect, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n  class: \"gestao-utilizadores\"\n};\nconst _hoisted_2 = {\n  class: \"tabela-container\"\n};\nconst _hoisted_3 = [\"onUpdate:modelValue\", \"onChange\"];\nconst _hoisted_4 = {\n  key: 0,\n  value: \"empregado\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  value: \"admin\"\n};\nconst _hoisted_6 = [\"onClick\"];\nconst _hoisted_7 = {\n  key: 0,\n  class: \"mensagem\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[3] || (_cache[3] = _createElementVNode(\"header\", null, [_createElementVNode(\"h1\", null, \"GestÃ£o de Utilizadores\")], -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"table\", null, [_cache[2] || (_cache[2] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", null, \"Nome\"), _createElementVNode(\"th\", null, \"Email\"), _createElementVNode(\"th\", null, \"Role\"), _createElementVNode(\"th\", null, \"AÃ§Ãµes\")])], -1 /* HOISTED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.utilizadores, u => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: u._id\n    }, [_createElementVNode(\"td\", null, _toDisplayString(u.nome), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(u.email), 1 /* TEXT */), _createElementVNode(\"td\", null, [_withDirectives(_createElementVNode(\"select\", {\n      \"onUpdate:modelValue\": $event => u.role = $event,\n      onChange: $event => $setup.atualizarRole(u)\n    }, [_cache[0] || (_cache[0] = _createElementVNode(\"option\", {\n      value: \"cliente\"\n    }, \"cliente\", -1 /* HOISTED */)), _cache[1] || (_cache[1] = _createElementVNode(\"option\", {\n      value: \"doador\"\n    }, \"doador\", -1 /* HOISTED */)), $setup.user.role === 'admin' ? (_openBlock(), _createElementBlock(\"option\", _hoisted_4, \"empregado\")) : _createCommentVNode(\"v-if\", true), $setup.user.role === 'admin' ? (_openBlock(), _createElementBlock(\"option\", _hoisted_5, \"admin\")) : _createCommentVNode(\"v-if\", true)], 40 /* PROPS, NEED_HYDRATION */, _hoisted_3), [[_vModelSelect, u.role]])]), _createElementVNode(\"td\", null, [_createElementVNode(\"button\", {\n      onClick: $event => $setup.apagarUtilizador(u._id)\n    }, \"ðŸ—‘ Apagar\", 8 /* PROPS */, _hoisted_6)])]);\n  }), 128 /* KEYED_FRAGMENT */))])]), $setup.mensagem ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, _toDisplayString($setup.mensagem), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])]);\n}","map":{"version":3,"names":["class","key","value","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_Fragment","_renderList","$setup","utilizadores","u","_id","_toDisplayString","nome","email","$event","role","onChange","atualizarRole","user","_hoisted_4","_createCommentVNode","_hoisted_5","_hoisted_3","onClick","apagarUtilizador","_hoisted_6","mensagem","_hoisted_7"],"sources":["C:\\Users\\heieb\\OneDrive\\Ambiente de Trabalho\\10ABRIL\\Projeto-PTR-PTI\\src\\components\\ChangeRole.vue"],"sourcesContent":["<template>\r\n  <div class=\"gestao-utilizadores\">\r\n    <header>\r\n      <h1>GestÃ£o de Utilizadores</h1>\r\n    </header>\r\n\r\n    <div class=\"tabela-container\">\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            <th>Nome</th>\r\n            <th>Email</th>\r\n            <th>Role</th>\r\n            <th>AÃ§Ãµes</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"u in utilizadores\" :key=\"u._id\">\r\n            <td>{{ u.nome }}</td>\r\n            <td>{{ u.email }}</td>\r\n            <td>\r\n              <select v-model=\"u.role\" @change=\"atualizarRole(u)\">\r\n                <option value=\"cliente\">cliente</option>\r\n                <option value=\"doador\">doador</option>\r\n                <option v-if=\"user.role === 'admin'\" value=\"empregado\">empregado</option>\r\n                <option v-if=\"user.role === 'admin'\" value=\"admin\">admin</option>\r\n              </select>\r\n            </td>\r\n            <td>\r\n              <button @click=\"apagarUtilizador(u._id)\">ðŸ—‘ Apagar</button>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n\r\n      <div v-if=\"mensagem\" class=\"mensagem\">{{ mensagem }}</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue';\r\nimport axios from 'axios';\r\n\r\nconst utilizadores = ref([]);\r\nconst mensagem = ref('');\r\nconst token = localStorage.getItem('token');\r\nconst user = ref(null);\r\n\r\nonMounted(async () => {\r\n  try {\r\n    const perfil = await axios.get('http://localhost:3000/api/perfil', {\r\n      headers: { Authorization: `Bearer ${token}` }\r\n    });\r\n    user.value = perfil.data;\r\n\r\n    const res = await axios.get('http://localhost:3000/api/utilizadores');\r\n    utilizadores.value = res.data;\r\n  } catch (err) {\r\n    console.error('Erro:', err);\r\n  }\r\n});\r\n\r\nasync function apagarUtilizador(id) {\r\n  try {\r\n    await axios.delete(`http://localhost:3000/api/utilizadores/${id}`);\r\n    utilizadores.value = utilizadores.value.filter(u => u._id !== id);\r\n    mensagem.value = 'Utilizador apagado com sucesso.';\r\n  } catch (err) {\r\n    mensagem.value = 'Erro ao apagar utilizador.';\r\n  }\r\n}\r\n\r\nasync function atualizarRole(utilizador) {\r\n  try {\r\n    await axios.put(`http://localhost:3000/api/utilizadores/${utilizador._id}`, {\r\n      role: utilizador.role,\r\n    });\r\n    mensagem.value = 'Role atualizada com sucesso.';\r\n  } catch (err) {\r\n    mensagem.value = 'Erro ao atualizar role.';\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.gestao-utilizadores {\r\n  padding: 40px;\r\n  max-width: 1000px;\r\n  margin: auto;\r\n  background: #f8f9fa;\r\n  border-radius: 10px;\r\n  box-shadow: 0 0 20px rgba(0,0,0,0.05);\r\n}\r\n\r\nheader {\r\n  background-color: #0d6efd;\r\n  color: white;\r\n  padding: 20px;\r\n  text-align: center;\r\n  border-radius: 10px 10px 0 0;\r\n}\r\n\r\n.tabela-container {\r\n  margin-top: 20px;\r\n  background: white;\r\n  border-radius: 10px;\r\n  overflow-x: auto;\r\n}\r\n\r\ntable {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n}\r\n\r\nthead {\r\n  background-color: #0d6efd;\r\n  color: white;\r\n}\r\n\r\nth, td {\r\n  padding: 12px 15px;\r\n  text-align: left;\r\n  border-bottom: 1px solid #ddd;\r\n}\r\n\r\nselect {\r\n  padding: 5px;\r\n  border-radius: 5px;\r\n  border: 1px solid #ccc;\r\n}\r\n\r\nbutton {\r\n  padding: 6px 10px;\r\n  background-color: crimson;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 5px;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n  transition: background 0.3s;\r\n}\r\n\r\nbutton:hover {\r\n  background-color: darkred;\r\n}\r\n\r\n.mensagem {\r\n  margin-top: 20px;\r\n  padding: 10px;\r\n  background-color: #d4edda;\r\n  color: #155724;\r\n  border-radius: 5px;\r\n}\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAqB;;EAKzBA,KAAK,EAAC;AAAkB;mBANjC;;EAAAC,GAAA;EAwBqDC,KAAK,EAAC;;;EAxB3DD,GAAA;EAyBqDC,KAAK,EAAC;;mBAzB3D;;EAAAD,GAAA;EAmC2BD,KAAK,EAAC;;;uBAlC/BG,mBAAA,CAoCM,OApCNC,UAoCM,G,0BAnCJC,mBAAA,CAES,iBADPA,mBAAA,CAA+B,YAA3B,wBAAsB,E,sBAG5BA,mBAAA,CA8BM,OA9BNC,UA8BM,GA7BJD,mBAAA,CA0BQ,gB,0BAzBNA,mBAAA,CAOQ,gBANNA,mBAAA,CAKK,aAJHA,mBAAA,CAAa,YAAT,MAAI,GACRA,mBAAA,CAAc,YAAV,OAAK,GACTA,mBAAA,CAAa,YAAT,MAAI,GACRA,mBAAA,CAAc,YAAV,OAAK,E,wBAGbA,mBAAA,CAgBQ,iB,kBAfNF,mBAAA,CAcKI,SAAA,QA/BfC,WAAA,CAiB0BC,MAAA,CAAAC,YAAY,EAAjBC,CAAC;yBAAZR,mBAAA,CAcK;MAd0BF,GAAG,EAAEU,CAAC,CAACC;QACpCP,mBAAA,CAAqB,YAAAQ,gBAAA,CAAdF,CAAC,CAACG,IAAI,kBACbT,mBAAA,CAAsB,YAAAQ,gBAAA,CAAfF,CAAC,CAACI,KAAK,kBACdV,mBAAA,CAOK,a,gBANHA,mBAAA,CAKS;MA1BvB,uBAAAW,MAAA,IAqB+BL,CAAC,CAACM,IAAI,GAAAD,MAAA;MAAGE,QAAM,EAAAF,MAAA,IAAEP,MAAA,CAAAU,aAAa,CAACR,CAAC;kCAC/CN,mBAAA,CAAwC;MAAhCH,KAAK,EAAC;IAAS,GAAC,SAAO,sB,0BAC/BG,mBAAA,CAAsC;MAA9BH,KAAK,EAAC;IAAQ,GAAC,QAAM,sBACfO,MAAA,CAAAW,IAAI,CAACH,IAAI,gB,cAAvBd,mBAAA,CAAyE,UAAzEkB,UAAyE,EAAlB,WAAS,KAxBhFC,mBAAA,gBAyB8Bb,MAAA,CAAAW,IAAI,CAACH,IAAI,gB,cAAvBd,mBAAA,CAAiE,UAAjEoB,UAAiE,EAAd,OAAK,KAzBxED,mBAAA,e,kCAAAE,UAAA,I,gBAqB+Bb,CAAC,CAACM,IAAI,E,KAOzBZ,mBAAA,CAEK,aADHA,mBAAA,CAA2D;MAAlDoB,OAAK,EAAAT,MAAA,IAAEP,MAAA,CAAAiB,gBAAgB,CAACf,CAAC,CAACC,GAAG;OAAG,WAAS,iBA7BhEe,UAAA,E;sCAmCiBlB,MAAA,CAAAmB,QAAQ,I,cAAnBzB,mBAAA,CAA0D,OAA1D0B,UAA0D,EAAAhB,gBAAA,CAAjBJ,MAAA,CAAAmB,QAAQ,oBAnCvDN,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}