{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vModelSelect as _vModelSelect } from \"vue\";\nconst _hoisted_1 = {\n  class: \"detalhes\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"info-utilizador\"\n};\nconst _hoisted_3 = {\n  key: 0,\n  value: \"admin\"\n};\nconst _hoisted_4 = {\n  key: 1,\n  value: \"empregado\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"mensagem\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"header\", null, [_cache[2] || (_cache[2] = _createElementVNode(\"h1\", null, \"Alterar Roles\", -1 /* HOISTED */)), _createElementVNode(\"button\", {\n    onClick: $setup.voltar\n  }, \"← Voltar\")]), _createElementVNode(\"section\", null, [_withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.nomeBusca = $event),\n    type: \"text\",\n    placeholder: \"Nome do utilizador\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.nomeBusca]]), _createElementVNode(\"button\", {\n    onClick: $setup.buscarUtilizador\n  }, \"Buscar\")]), $setup.utilizador ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"h2\", null, _toDisplayString($setup.utilizador.nome), 1 /* TEXT */), _createElementVNode(\"p\", null, \"Email: \" + _toDisplayString($setup.utilizador.email), 1 /* TEXT */), _createElementVNode(\"p\", null, [_cache[3] || (_cache[3] = _createTextVNode(\"Role atual: \")), _createElementVNode(\"strong\", null, _toDisplayString($setup.utilizador.role), 1 /* TEXT */)]), _cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n    for: \"novaRole\"\n  }, \"Nova Role:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"select\", {\n    id: \"novaRole\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.novaRole = $event)\n  }, [_cache[4] || (_cache[4] = _createElementVNode(\"option\", {\n    value: \"cliente\"\n  }, \"cliente\", -1 /* HOISTED */)), $setup.user && $setup.user.role === 'admin' ? (_openBlock(), _createElementBlock(\"option\", _hoisted_3, \"admin\")) : _createCommentVNode(\"v-if\", true), $setup.user && $setup.user.role === 'admin' ? (_openBlock(), _createElementBlock(\"option\", _hoisted_4, \"empregado\")) : _createCommentVNode(\"v-if\", true), _cache[5] || (_cache[5] = _createElementVNode(\"option\", {\n    value: \"doador\"\n  }, \"doador\", -1 /* HOISTED */))], 512 /* NEED_PATCH */), [[_vModelSelect, $setup.novaRole]]), _createElementVNode(\"button\", {\n    onClick: $setup.alterarRole\n  }, \"Alterar Role\")])) : _createCommentVNode(\"v-if\", true), $setup.mensagem ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, _toDisplayString($setup.mensagem), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","key","value","_createElementBlock","_hoisted_1","_createElementVNode","onClick","$setup","voltar","_cache","$event","nomeBusca","type","placeholder","buscarUtilizador","utilizador","_hoisted_2","_toDisplayString","nome","email","_createTextVNode","role","for","id","novaRole","user","_hoisted_3","_createCommentVNode","_hoisted_4","alterarRole","mensagem","_hoisted_5"],"sources":["C:\\Users\\heieb\\OneDrive\\Ambiente de Trabalho\\10ABRIL\\Projeto-PTR-PTI\\src\\components\\ChangeRole.vue"],"sourcesContent":["<template>\r\n  <div class=\"detalhes\">\r\n    <header>\r\n      <h1>Alterar Roles</h1>\r\n      <button @click=\"voltar\">← Voltar</button>\r\n    </header>\r\n\r\n    <section>\r\n      <input\r\n        v-model=\"nomeBusca\"\r\n        type=\"text\"\r\n        placeholder=\"Nome do utilizador\"\r\n      />\r\n      <button @click=\"buscarUtilizador\">Buscar</button>\r\n    </section>\r\n\r\n    <div v-if=\"utilizador\" class=\"info-utilizador\">\r\n      <h2>{{ utilizador.nome }}</h2>\r\n      <p>Email: {{ utilizador.email }}</p>\r\n      <p>Role atual: <strong>{{ utilizador.role }}</strong></p>\r\n\r\n      <label for=\"novaRole\">Nova Role:</label>\r\n      <select id=\"novaRole\" v-model=\"novaRole\">\r\n        <option value=\"cliente\">cliente</option>\r\n        <option v-if=\"user && (user.role === 'admin')\" value=\"admin\">admin</option>\r\n        <option v-if=\"user && (user.role === 'admin')\" value=\"empregado\">empregado</option>\r\n        <option value=\"doador\">doador</option>\r\n        \r\n      </select>\r\n\r\n      <button @click=\"alterarRole\">Alterar Role</button>\r\n    </div>\r\n\r\n    <div v-if=\"mensagem\" class=\"mensagem\">{{ mensagem }}</div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue';\r\nimport axios from 'axios';\r\nimport { useRouter } from 'vue-router';\r\n\r\nconst router = useRouter();\r\nconst nomeBusca = ref('');\r\nconst utilizador = ref(null);\r\nconst novaRole = ref('');\r\nconst mensagem = ref('');\r\nconst token = localStorage.getItem('token');\r\nconst user = ref(null);\r\n\r\nfunction voltar() {\r\n  router.back();\r\n}\r\n\r\n\r\n\r\nasync function buscarUtilizador() {\r\n  try {\r\n    const res = await axios.get(`http://localhost:3000/api/utilizadores/nome/${nomeBusca.value}`);\r\n    utilizador.value = res.data;\r\n    novaRole.value = res.data.role;\r\n    mensagem.value = '';\r\n  } catch (err) {\r\n    utilizador.value = null;\r\n    mensagem.value = 'Utilizador não encontrado.';\r\n  }\r\n}\r\n\r\nasync function alterarRole() {\r\n  if (!utilizador.value || !novaRole.value) return;\r\n\r\n  try {\r\n    const res = await axios.put(`http://localhost:3000/api/utilizadores/${utilizador.value._id}`, {\r\n      role: novaRole.value,\r\n    });\r\n\r\n    utilizador.value = res.data;\r\n    mensagem.value = 'Role atualizada com sucesso!';\r\n  } catch (err) {\r\n    console.error(err);\r\n    mensagem.value = 'Erro ao atualizar role.';\r\n  }\r\n}\r\n\r\nonMounted(async () => {\r\n  \r\n  try {\r\n\r\n    const resUser = await axios.get('http://localhost:3000/api/perfil', {\r\n      headers: {\r\n        Authorization: `Bearer ${token}`\r\n      }\r\n  });\r\n\r\n  console.log('Usuário carregado:', user.value);\r\n\r\n   user.value = resUser.data;\r\n\r\n  } catch (err) {\r\n    console.error('Erro ao buscar equipamentos:', err);\r\n  }\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.detalhes {\r\n  max-width: 800px;\r\n  margin: 40px auto;\r\n  padding: 20px;\r\n  background-color: #f8f9fa;\r\n  border-radius: 10px;\r\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\nheader {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\ninput,\r\nselect {\r\n  padding: 10px;\r\n  margin: 10px 0;\r\n  width: 100%;\r\n}\r\n\r\nbutton {\r\n  background-color: #0d6efd;\r\n  color: white;\r\n  border: none;\r\n  padding: 10px 15px;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n}\r\n\r\nbutton:hover {\r\n  background-color: #084298;\r\n}\r\n\r\n.info-utilizador {\r\n  margin-top: 20px;\r\n  background: #fff;\r\n  padding: 15px;\r\n  border-radius: 10px;\r\n  box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.mensagem {\r\n  margin-top: 20px;\r\n  font-weight: bold;\r\n  color: green;\r\n}\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAU;;EADvBC,GAAA;EAgB2BD,KAAK,EAAC;;;EAhBjCC,GAAA;EAwBuDC,KAAK,EAAC;;;EAxB7DD,GAAA;EAyBuDC,KAAK,EAAC;;;EAzB7DD,GAAA;EAiCyBD,KAAK,EAAC;;;uBAhC7BG,mBAAA,CAiCM,OAjCNC,UAiCM,GAhCJC,mBAAA,CAGS,iB,0BAFPA,mBAAA,CAAsB,YAAlB,eAAa,sBACjBA,mBAAA,CAAyC;IAAhCC,OAAK,EAAEC,MAAA,CAAAC;EAAM,GAAE,UAAQ,E,GAGlCH,mBAAA,CAOU,kB,gBANRA,mBAAA,CAIE;IAZR,uBAAAI,MAAA,QAAAA,MAAA,MAAAC,MAAA,IASiBH,MAAA,CAAAI,SAAS,GAAAD,MAAA;IAClBE,IAAI,EAAC,MAAM;IACXC,WAAW,EAAC;iDAFHN,MAAA,CAAAI,SAAS,E,GAIpBN,mBAAA,CAAiD;IAAxCC,OAAK,EAAEC,MAAA,CAAAO;EAAgB,GAAE,QAAM,E,GAG/BP,MAAA,CAAAQ,UAAU,I,cAArBZ,mBAAA,CAeM,OAfNa,UAeM,GAdJX,mBAAA,CAA8B,YAAAY,gBAAA,CAAvBV,MAAA,CAAAQ,UAAU,CAACG,IAAI,kBACtBb,mBAAA,CAAoC,WAAjC,SAAO,GAAAY,gBAAA,CAAGV,MAAA,CAAAQ,UAAU,CAACI,KAAK,kBAC7Bd,mBAAA,CAAyD,Y,0BAnB/De,gBAAA,CAmBS,cAAY,IAAAf,mBAAA,CAAsC,gBAAAY,gBAAA,CAA3BV,MAAA,CAAAQ,UAAU,CAACM,IAAI,iB,6BAEzChB,mBAAA,CAAwC;IAAjCiB,GAAG,EAAC;EAAU,GAAC,YAAU,sB,gBAChCjB,mBAAA,CAMS;IANDkB,EAAE,EAAC,UAAU;IAtB3B,uBAAAd,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAsBqCH,MAAA,CAAAiB,QAAQ,GAAAd,MAAA;gCACrCL,mBAAA,CAAwC;IAAhCH,KAAK,EAAC;EAAS,GAAC,SAAO,sBACjBK,MAAA,CAAAkB,IAAI,IAAKlB,MAAA,CAAAkB,IAAI,CAACJ,IAAI,gB,cAAhClB,mBAAA,CAA2E,UAA3EuB,UAA2E,EAAd,OAAK,KAxB1EC,mBAAA,gBAyBsBpB,MAAA,CAAAkB,IAAI,IAAKlB,MAAA,CAAAkB,IAAI,CAACJ,IAAI,gB,cAAhClB,mBAAA,CAAmF,UAAnFyB,UAAmF,EAAlB,WAAS,KAzBlFD,mBAAA,gB,0BA0BQtB,mBAAA,CAAsC;IAA9BH,KAAK,EAAC;EAAQ,GAAC,QAAM,qB,0CAJAK,MAAA,CAAAiB,QAAQ,E,GAQvCnB,mBAAA,CAAkD;IAAzCC,OAAK,EAAEC,MAAA,CAAAsB;EAAW,GAAE,cAAY,E,KA9B/CF,mBAAA,gBAiCepB,MAAA,CAAAuB,QAAQ,I,cAAnB3B,mBAAA,CAA0D,OAA1D4B,UAA0D,EAAAd,gBAAA,CAAjBV,MAAA,CAAAuB,QAAQ,oBAjCrDH,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}