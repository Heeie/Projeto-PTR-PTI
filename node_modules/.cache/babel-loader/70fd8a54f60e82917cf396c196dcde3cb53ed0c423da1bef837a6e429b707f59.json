{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport { ref, onMounted } from 'vue';\nimport axios from 'axios';\nimport { useRouter } from 'vue-router';\nexport default {\n  __name: 'ChangeRole',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const utilizadores = ref([]);\n    const mensagem = ref('');\n    const token = localStorage.getItem('token');\n    const user = ref(null);\n    onMounted(async () => {\n      try {\n        const perfil = await axios.get('http://localhost:3000/api/perfil', {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        user.value = perfil.data;\n        const res = await axios.get('http://localhost:3000/api/utilizadores');\n        utilizadores.value = res.data;\n      } catch (err) {\n        console.error('Erro:', err);\n      }\n    });\n    async function apagarUtilizador(id) {\n      try {\n        await axios.delete(`http://localhost:3000/api/utilizadores/${id}`);\n        utilizadores.value = utilizadores.value.filter(u => u._id !== id);\n        mensagem.value = 'Utilizador apagado com sucesso.';\n      } catch (err) {\n        mensagem.value = 'Erro ao apagar utilizador.';\n      }\n    }\n    async function atualizarRole(utilizador) {\n      try {\n        await axios.put(`http://localhost:3000/api/utilizadores/${utilizador._id}`, {\n          role: utilizador.role\n        });\n        mensagem.value = 'Role atualizada com sucesso.';\n      } catch (err) {\n        mensagem.value = 'Erro ao atualizar role.';\n      }\n    }\n    const __returned__ = {\n      router,\n      utilizadores,\n      mensagem,\n      token,\n      user,\n      apagarUtilizador,\n      atualizarRole,\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","useRouter","router","utilizadores","mensagem","token","localStorage","getItem","user","perfil","get","headers","Authorization","value","data","res","err","console","error","apagarUtilizador","id","delete","filter","u","_id","atualizarRole","utilizador","put","role"],"sources":["C:/Users/heieb/OneDrive/Ambiente de Trabalho/10ABRIL/Projeto-PTR-PTI/src/components/ChangeRole.vue"],"sourcesContent":["<template>\r\n  <div class=\"gestao-utilizadores\">\r\n    <div class=\"voltar-container\">\r\n  <button class=\"voltar-btn\" @click=\"router.push('/home')\">â¬… Voltar Ã  PÃ¡gina Principal</button>\r\n</div>\r\n\r\n    <header>\r\n      <h1>GestÃ£o de Utilizadores</h1>\r\n    </header>\r\n\r\n    <div class=\"tabela-container\">\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            <th>Nome</th>\r\n            <th>Email</th>\r\n            <th>Role</th>\r\n            <th>AÃ§Ãµes</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"u in utilizadores\" :key=\"u._id\">\r\n            <td>{{ u.nome }}</td>\r\n            <td>{{ u.email }}</td>\r\n            <td>\r\n              <select v-model=\"u.role\" @change=\"atualizarRole(u)\">\r\n                <option value=\"cliente\">cliente</option>\r\n                <option value=\"doador\">doador</option>\r\n                <option v-if=\"user.role === 'admin'\" value=\"empregado\">empregado</option>\r\n                <option v-if=\"user.role === 'admin'\" value=\"admin\">admin</option>\r\n              </select>\r\n            </td>\r\n            <td>\r\n              <button @click=\"apagarUtilizador(u._id)\">ðŸ—‘ Apagar</button>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n\r\n      <div v-if=\"mensagem\" class=\"mensagem\">{{ mensagem }}</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue';\r\nimport axios from 'axios';\r\nimport { useRouter } from 'vue-router';\r\nconst router = useRouter();\r\n\r\n\r\nconst utilizadores = ref([]);\r\nconst mensagem = ref('');\r\nconst token = localStorage.getItem('token');\r\nconst user = ref(null);\r\n\r\nonMounted(async () => {\r\n  try {\r\n    const perfil = await axios.get('http://localhost:3000/api/perfil', {\r\n      headers: { Authorization: `Bearer ${token}` }\r\n    });\r\n    user.value = perfil.data;\r\n\r\n    const res = await axios.get('http://localhost:3000/api/utilizadores');\r\n    utilizadores.value = res.data;\r\n  } catch (err) {\r\n    console.error('Erro:', err);\r\n  }\r\n});\r\n\r\nasync function apagarUtilizador(id) {\r\n  try {\r\n    await axios.delete(`http://localhost:3000/api/utilizadores/${id}`);\r\n    utilizadores.value = utilizadores.value.filter(u => u._id !== id);\r\n    mensagem.value = 'Utilizador apagado com sucesso.';\r\n  } catch (err) {\r\n    mensagem.value = 'Erro ao apagar utilizador.';\r\n  }\r\n}\r\n\r\nasync function atualizarRole(utilizador) {\r\n  try {\r\n    await axios.put(`http://localhost:3000/api/utilizadores/${utilizador._id}`, {\r\n      role: utilizador.role,\r\n    });\r\n    mensagem.value = 'Role atualizada com sucesso.';\r\n  } catch (err) {\r\n    mensagem.value = 'Erro ao atualizar role.';\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.voltar-container {\r\n  margin: 20px 0;\r\n  text-align: left;\r\n}\r\n\r\n.voltar-btn {\r\n  padding: 10px 20px;\r\n  background-color: lightblue;\r\n  color: black;\r\n  border: none;\r\n  border-radius: 6px;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.voltar-btn:hover {\r\n  background-color: #0d6efd;\r\n  color: white;\r\n}\r\n\r\n\r\n.gestao-utilizadores {\r\n  padding: 40px;\r\n  max-width: 1000px;\r\n  margin: auto;\r\n  background: #f8f9fa;\r\n  border-radius: 10px;\r\n  box-shadow: 0 0 20px rgba(0,0,0,0.05);\r\n}\r\n\r\nheader {\r\n  background-color: #0d6efd;\r\n  color: white;\r\n  padding: 20px;\r\n  text-align: center;\r\n  border-radius: 10px 10px 0 0;\r\n}\r\n\r\n.tabela-container {\r\n  margin-top: 20px;\r\n  background: white;\r\n  border-radius: 10px;\r\n  overflow-x: auto;\r\n}\r\n\r\ntable {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n}\r\n\r\nthead {\r\n  background-color: #0d6efd;\r\n  color: white;\r\n}\r\n\r\nth, td {\r\n  padding: 12px 15px;\r\n  text-align: left;\r\n  border-bottom: 1px solid #ddd;\r\n}\r\n\r\nselect {\r\n  padding: 5px;\r\n  border-radius: 5px;\r\n  border: 1px solid #ccc;\r\n}\r\n\r\nbutton {\r\n  padding: 6px 10px;\r\n  background-color: crimson;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 5px;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n  transition: background 0.3s;\r\n}\r\n\r\nbutton:hover {\r\n  background-color: darkred;\r\n}\r\n\r\n.mensagem {\r\n  margin-top: 20px;\r\n  padding: 10px;\r\n  background-color: #d4edda;\r\n  color: #155724;\r\n  border-radius: 5px;\r\n}\r\n</style>\r\n"],"mappings":";;AA6CA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,SAAS,QAAQ,YAAY;;;;;;;IACtC,MAAMC,MAAM,GAAGD,SAAS,CAAC,CAAC;IAG1B,MAAME,YAAY,GAAGL,GAAG,CAAC,EAAE,CAAC;IAC5B,MAAMM,QAAQ,GAAGN,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMO,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,MAAMC,IAAI,GAAGV,GAAG,CAAC,IAAI,CAAC;IAEtBC,SAAS,CAAC,YAAY;MACpB,IAAI;QACF,MAAMU,MAAM,GAAG,MAAMT,KAAK,CAACU,GAAG,CAAC,kCAAkC,EAAE;UACjEC,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUP,KAAK;UAAG;QAC9C,CAAC,CAAC;QACFG,IAAI,CAACK,KAAK,GAAGJ,MAAM,CAACK,IAAI;QAExB,MAAMC,GAAG,GAAG,MAAMf,KAAK,CAACU,GAAG,CAAC,wCAAwC,CAAC;QACrEP,YAAY,CAACU,KAAK,GAAGE,GAAG,CAACD,IAAI;MAC/B,CAAC,CAAC,OAAOE,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAAC,OAAO,EAAEF,GAAG,CAAC;MAC7B;IACF,CAAC,CAAC;IAEF,eAAeG,gBAAgBA,CAACC,EAAE,EAAE;MAClC,IAAI;QACF,MAAMpB,KAAK,CAACqB,MAAM,CAAC,0CAA0CD,EAAE,EAAE,CAAC;QAClEjB,YAAY,CAACU,KAAK,GAAGV,YAAY,CAACU,KAAK,CAACS,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,GAAG,KAAKJ,EAAE,CAAC;QACjEhB,QAAQ,CAACS,KAAK,GAAG,iCAAiC;MACpD,CAAC,CAAC,OAAOG,GAAG,EAAE;QACZZ,QAAQ,CAACS,KAAK,GAAG,4BAA4B;MAC/C;IACF;IAEA,eAAeY,aAAaA,CAACC,UAAU,EAAE;MACvC,IAAI;QACF,MAAM1B,KAAK,CAAC2B,GAAG,CAAC,0CAA0CD,UAAU,CAACF,GAAG,EAAE,EAAE;UAC1EI,IAAI,EAAEF,UAAU,CAACE;QACnB,CAAC,CAAC;QACFxB,QAAQ,CAACS,KAAK,GAAG,8BAA8B;MACjD,CAAC,CAAC,OAAOG,GAAG,EAAE;QACZZ,QAAQ,CAACS,KAAK,GAAG,yBAAyB;MAC5C;IACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}